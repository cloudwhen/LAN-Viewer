# 局域网共享文件查看器

一个功能强大的局域网文件共享工具，支持本地文件管理、局域网计算机扫描、共享文件夹访问、文件浏览、下载和上传功能。

## 功能特性

### 本地文件模式
- 📁 文件浏览：查看本地共享目录中的所有文件和文件夹
- 📥 文件下载：一键下载任意文件
- 📤 文件上传：支持上传文件到本地共享目录
- 🌐 局域网访问：同一局域网内的设备均可访问

### 局域网共享模式
- 🔍 扫描局域网：自动发现局域网中的所有计算机
- 📂 查看共享文件夹：浏览其他计算机的共享文件夹
- 📥 下载网络文件：从其他计算机下载文件
- 🖥️ 计算机管理：方便地查看和管理网络中的计算机

### 通用特性
- 🎨 美观界面：简洁现代的 Web 界面
- ⚡ 快速响应：优化的文件加载和传输
- 🔄 实时更新：动态加载文件列表

## 安装步骤

1. 安装依赖：
```bash
npm install
```

2. 启动服务器：
```bash
npm start
```

## 使用方法

### 本地文件模式

1. 启动服务器后，控制台会显示访问地址：
   - 本地访问：`http://localhost:3000`
   - 局域网访问：`http://[你的IP地址]:3000`

2. 在浏览器中打开访问地址

3. 将文件放入 `shared-files` 目录即可共享

4. 局域网内的其他设备可以通过你的 IP 地址访问

### 局域网共享模式

1. 点击界面上的"局域网共享"按钮切换到网络模式

2. **扫描方式一：自动扫描**
   - 点击"扫描局域网"按钮，系统会自动发现局域网中的所有计算机

3. **扫描方式二：指定网段扫描**
   - 在输入框中输入网段（如：`192.168.1`）
   - 点击"扫描局域网"按钮，系统会扫描该网段内的所有 IP 地址（1-254）
   - 扫描完成后会显示在线的计算机及其 IP 地址

4. 点击任意计算机查看其共享文件夹

5. 点击共享文件夹浏览其中的文件

6. 点击文件即可下载到本地

### 注意事项

- 确保目标计算机已开启文件共享功能
- 确保防火墙允许 3000 端口的访问
- 上传文件大小限制为 100MB（仅本地模式）
- 仅在局域网内使用，不要暴露到公网

## Windows 文件共享设置

如果其他计算机没有出现在扫描列表中，请确保：

1. **开启文件共享**：
   - 打开"控制面板" > "网络和共享中心"
   - 点击"更改高级共享设置"
   - 启用"启用网络发现"和"启用文件和打印机共享"

2. **设置共享文件夹**：
   - 右键点击要共享的文件夹
   - 选择"属性" > "共享"选项卡
   - 点击"共享"按钮，选择要共享的用户

3. **检查网络类型**：
   - 确保网络设置为"专用网络"而非"公用网络"

## 目录结构

```
.
├── server.js           # 后端服务器
├── package.json        # 项目配置
├── public/
│   └── index.html     # 前端界面
└── shared-files/      # 本地共享文件目录（自动创建）
```

## 技术栈

- 后端：Node.js + Express
- 前端：原生 HTML + CSS + JavaScript
- 网络扫描：Windows 原生命令（net view）
- 文件共享：SMB/CIFS 协议

## API 接口

### 本地文件
- `GET /api/files` - 获取本地文件列表
- `GET /api/files/*` - 获取子目录文件或下载文件
- `POST /api/upload` - 上传文件

### 局域网共享
- `GET /api/network/computers` - 扫描局域网计算机
  - 可选参数：`segment` - 指定网段（如：192.168.1），不传则使用 net view 自动发现
- `GET /api/network/shares?computer=xxx` - 获取计算机的共享文件夹
- `GET /api/network/files?share=xxx&path=xxx` - 获取共享文件夹中的文件
- `GET /api/network/download?share=xxx&path=xxx` - 下载网络文件

## 常见问题

**Q: 扫描不到其他计算机？**
A: 请确保其他计算机已开启文件共享，并且与当前计算机在同一局域网内。也可以尝试使用网段扫描功能。

**Q: 如何使用网段扫描？**
A: 在"局域网共享"模式下，在输入框中输入网段（如：192.168.1），然后点击"扫描局域网"按钮。系统会扫描该网段内所有 IP 地址（1-254）。

**Q: 网段扫描需要多长时间？**
A: 扫描一个完整的网段（254 个 IP）大约需要 30-60 秒，取决于网络响应速度。

**Q: 无法访问某些共享文件夹？**
A: 可能是权限问题，请检查共享文件夹的访问权限设置。

**Q: 下载速度慢？**
A: 下载速度取决于网络带宽和目标计算机的性能。

**Q: 支持哪些操作系统？**
A: 目前仅支持 Windows 系统，因为使用了 Windows 原生命令进行网络扫描。